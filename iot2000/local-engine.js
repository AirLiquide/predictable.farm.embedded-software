/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/*!**************************!*\
  !*** ./enums/redtype.js ***!
  \**************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar redtype = exports.redtype = {\n    math_average: \"math_average\",\n    math_equal: \"math_equal\",\n    math_inferior: \"math_inferior\",\n    math_inferior_equal: \"math_inferior_equal\",\n    math_superior: \"math_superior\",\n    math_superior_equal: \"math_superior_equal\",\n    logic_and: \"logic_and\",\n    logic_or: \"logic_or\",\n    scheduler: \"scheduler\",\n\n    global_actuator: \"global_actuator\"\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9lbnVtcy9yZWR0eXBlLmpzPzNlYzUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGxldCByZWR0eXBlID0ge1xuICAgIG1hdGhfYXZlcmFnZTpcIm1hdGhfYXZlcmFnZVwiLFxuICAgIG1hdGhfZXF1YWw6XCJtYXRoX2VxdWFsXCIsXG4gICAgbWF0aF9pbmZlcmlvcjpcIm1hdGhfaW5mZXJpb3JcIixcbiAgICBtYXRoX2luZmVyaW9yX2VxdWFsOlwibWF0aF9pbmZlcmlvcl9lcXVhbFwiLFxuICAgIG1hdGhfc3VwZXJpb3I6XCJtYXRoX3N1cGVyaW9yXCIsXG4gICAgbWF0aF9zdXBlcmlvcl9lcXVhbDpcIm1hdGhfc3VwZXJpb3JfZXF1YWxcIixcbiAgICBsb2dpY19hbmQ6XCJsb2dpY19hbmRcIixcbiAgICBsb2dpY19vcjpcImxvZ2ljX29yXCIsXG4gICAgc2NoZWR1bGVyOlwic2NoZWR1bGVyXCIsXG5cbiAgICBnbG9iYWxfYWN0dWF0b3I6XCJnbG9iYWxfYWN0dWF0b3JcIlxufTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZW51bXMvcmVkdHlwZS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _engine = __webpack_require__(/*! ./class/engine */ 2);\n\nvar _engine2 = _interopRequireDefault(_engine);\n\nvar _sensor = __webpack_require__(/*! ./class/sensor */ 5);\n\nvar _sensor2 = _interopRequireDefault(_sensor);\n\nvar _ConfigHelper = __webpack_require__(/*! ./class/ConfigHelper */ 6);\n\nvar _ConfigHelper2 = _interopRequireDefault(_ConfigHelper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar LOCAL_ENGINE_PORT = 6500;\n\nvar sensorHelper = new _sensor2.default();\nvar configHelper = new _ConfigHelper2.default();\nvar engine = new _engine2.default(sensorHelper, configHelper);\n\nconfigHelper.engine = engine;\n\nvar io = {};\n\nif (true) {\n    io = eval('require')('/usr/lib/node_modules/socket.io')(LOCAL_ENGINE_PORT);\n    console.log(\"LOCAL ENGINE STARTED\");\n} else {\n    io = require('socket.io')(LOCAL_ENGINE_PORT);\n}\n\nio.on('connection', function (socket) {\n    engine.setSocket(socket);\n    socket.emit('get-config');\n\n    socket.on('set-config', function (data) {\n        configHelper.graph = data.graph;\n\n        if (typeof data.device_id === \"string\") {\n            configHelper.deviceid = data.device_id;\n        } else {\n            configHelper.deviceid = data.device_id.toString();\n        }\n\n        var conf = configHelper.getConfig();\n\n        socket.emit('config-ok', conf);\n\n        configHelper.ready = true;\n\n        if (conf.type === 'server') {\n            setTimeout(function () {\n                computeDelay();\n            }, 5000);\n        }\n    });\n\n    socket.on('sensor-emit', function (data) {\n        if (configHelper.ready) {\n            sensorHelper.updateData(data);\n        }\n    });\n});\n\nfunction computeDelay() {\n    engine.compute();\n    setTimeout(function () {\n        computeDelay();\n    }, 2000);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9pbmRleC5qcz8xNjg3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFbmdpbmUgZnJvbSAnLi9jbGFzcy9lbmdpbmUnO1xuaW1wb3J0IFNlbnNvciBmcm9tICcuL2NsYXNzL3NlbnNvcic7XG5pbXBvcnQgQ29uZmlnSGVscGVyIGZyb20gXCIuL2NsYXNzL0NvbmZpZ0hlbHBlclwiO1xuXG5jb25zdCBMT0NBTF9FTkdJTkVfUE9SVCA9IDY1MDA7XG5cbmxldCBzZW5zb3JIZWxwZXIgPSBuZXcgU2Vuc29yKCk7XG5sZXQgY29uZmlnSGVscGVyID0gbmV3IENvbmZpZ0hlbHBlcigpO1xubGV0IGVuZ2luZSA9IG5ldyBFbmdpbmUoc2Vuc29ySGVscGVyLCBjb25maWdIZWxwZXIpO1xuXG5jb25maWdIZWxwZXIuZW5naW5lID0gZW5naW5lO1xuXG5sZXQgaW8gPSB7fTtcblxuaWYoQ09OVEVYVCA9PT0gJ2xpbmlubycgfHzCoENPTlRFWFQgPT09ICdpb3QyMDAwJykge1xuICAgIGlvID0gZXZhbCgncmVxdWlyZScpKCcvdXNyL2xpYi9ub2RlX21vZHVsZXMvc29ja2V0LmlvJykoTE9DQUxfRU5HSU5FX1BPUlQpO1xuICAgIGNvbnNvbGUubG9nKFwiTE9DQUwgRU5HSU5FIFNUQVJURURcIik7XG59IGVsc2Uge1xuICAgIGlvID0gcmVxdWlyZSgnc29ja2V0LmlvJykoTE9DQUxfRU5HSU5FX1BPUlQpO1xufVxuXG5pby5vbignY29ubmVjdGlvbicsIGZ1bmN0aW9uIChzb2NrZXQpIHtcbiAgICBlbmdpbmUuc2V0U29ja2V0KHNvY2tldCk7XG4gICAgc29ja2V0LmVtaXQoJ2dldC1jb25maWcnKTtcblxuICAgIHNvY2tldC5vbignc2V0LWNvbmZpZycsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgY29uZmlnSGVscGVyLmdyYXBoID0gZGF0YS5ncmFwaDtcblxuICAgICAgICBpZiAodHlwZW9mIGRhdGEuZGV2aWNlX2lkID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb25maWdIZWxwZXIuZGV2aWNlaWQgPSBkYXRhLmRldmljZV9pZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbmZpZ0hlbHBlci5kZXZpY2VpZCA9IGRhdGEuZGV2aWNlX2lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgY29uZiA9IGNvbmZpZ0hlbHBlci5nZXRDb25maWcoKTtcblxuICAgICAgICBzb2NrZXQuZW1pdCgnY29uZmlnLW9rJywgY29uZik7XG5cbiAgICAgICAgY29uZmlnSGVscGVyLnJlYWR5ID0gdHJ1ZTtcblxuICAgICAgICBpZihjb25mLnR5cGUgPT09ICdzZXJ2ZXInKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjb21wdXRlRGVsYXkoKTsgfSwgNTAwMCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHNvY2tldC5vbignc2Vuc29yLWVtaXQnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmKGNvbmZpZ0hlbHBlci5yZWFkeSkge1xuICAgICAgICAgICAgc2Vuc29ySGVscGVyLnVwZGF0ZURhdGEoZGF0YSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG5mdW5jdGlvbiBjb21wdXRlRGVsYXkoKSB7XG4gICAgZW5naW5lLmNvbXB1dGUoKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjb21wdXRlRGVsYXkoKTsgfSwgMjAwMCk7XG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGluZGV4LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/*!*************************!*\
  !*** ./class/engine.js ***!
  \*************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _reader = __webpack_require__(/*! ./reader */ 3);\n\nvar _reader2 = _interopRequireDefault(_reader);\n\nvar _redtype = __webpack_require__(/*! ../enums/redtype */ 0);\n\nvar _scheduler = __webpack_require__(/*! ./scheduler */ 4);\n\nvar _scheduler2 = _interopRequireDefault(_scheduler);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Engine = function () {\n    function Engine(sensorHelper, configHelper) {\n        _classCallCheck(this, Engine);\n\n        this.reader = new _reader2.default(configHelper);\n        this.sensorHelper = sensorHelper;\n        this.configHelper = configHelper;\n        this.socket = null;\n        this.idCycle = '';\n\n        this.subcondition = [];\n        this.queueEntryPoint = [];\n    }\n\n    _createClass(Engine, [{\n        key: \"compute\",\n        value: function compute() {\n            this.idCycle = this.getIdCycle();\n\n            if (this.configHelper.graph !== null) {\n                for (var i = 0; i < this.reader.getEntryPointNode().length; i++) {\n                    this.queueEntryPoint.push(this.reader.getEntryPointNode()[i]);\n                }\n\n                this.extractSubCondition(this.queueEntryPoint.shift().id);\n            }\n        }\n    }, {\n        key: \"getIdCycle\",\n        value: function getIdCycle() {\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = Math.random() * 16 | 0,\n                    v = c == 'x' ? r : r & 0x3 | 0x8;\n                return v.toString(16);\n            });\n        }\n    }, {\n        key: \"setSocket\",\n        value: function setSocket(socket) {\n            this.socket = socket;\n        }\n    }, {\n        key: \"setScheadulerNodeStatut\",\n        value: function setScheadulerNodeStatut(node) {\n            if (this.sensorHelper.scheduler[node.id] === undefined) {\n                this.sensorHelper.scheduler[node.id] = { cycle: this.idCycle, timestamp: Math.round(new Date().getTime() / 1000) };\n            }\n\n            if (this.sensorHelper.scheduler[node.id].cycle !== this.idCycle) {\n                this.subcondition[node.id] = false;\n            }\n\n            if (new _scheduler2.default(node, this.sensorHelper, this.idCycle).getScheadulerNodeStatut()) {\n                this.sensorHelper.scheduler[node.id] = { cycle: this.idCycle, timestamp: Math.round(new Date().getTime() / 1000) };\n                this.subcondition[node.id] = true;\n            }\n        }\n    }, {\n        key: \"extractSubCondition\",\n        value: function extractSubCondition(entrypoint) {\n            var finished = false;\n\n            var parent = this.reader.getNodeFromId(entrypoint);\n            var child = this.reader.getNodeFromId(parent.wires[0][0]);\n\n            if (child.wires.length === 0) {\n                finished = true;\n            }\n\n            switch (child.type) {\n                case _redtype.redtype.math_average:\n                    var amount = child.amount;\n                    if (child.delayType === 'minutes') {\n                        amount = amount * 60;\n                    }\n\n                    if (child.delayType === 'hours') {\n                        amount = amount * 3600;\n                    }\n\n                    this.subcondition[child.id] = false;\n\n                    if (this.sensorHelper.math_average[child.id] === undefined) {\n                        this.sensorHelper.math_average[child.id] = {\n                            timestamp: Math.round(new Date().getTime() / 1000),\n                            amount: amount\n                        };\n                    } else {\n                        if (Math.round(new Date().getTime() / 1000) - this.sensorHelper.math_average[child.id].timestamp >= amount) {\n                            this.sensorHelper.math_average[child.id].timestamp = Math.round(new Date().getTime() / 1000);\n                            this.subcondition[child.id] = true;\n                        }\n                    }\n                    break;\n\n                case _redtype.redtype.math_inferior:\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === null) {\n                        this.subcondition[child.id] = false;\n                        break;\n                    }\n\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) < child.value) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.math_inferior_equal:\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === null) {\n                        this.subcondition[child.id] = false;\n                        break;\n                    }\n\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) <= child.value) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.math_equal:\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === null) {\n                        this.subcondition[child.id] = false;\n                        break;\n                    }\n\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === child.value) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.math_superior:\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === null) {\n                        this.subcondition[child.id] = false;\n                        break;\n                    }\n\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) > child.value) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.math_superior_equal:\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) === null) {\n                        this.subcondition[child.id] = false;\n                        break;\n                    }\n\n                    if (this.sensorHelper.getSensorValueByIdAndType(this.configHelper.deviceid, parent.type) >= child.value) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.logic_and:\n                    var conditionLogicAndOk = true;\n\n                    for (var i = 0; i < this.reader.getConnectedNodeParentsFromId(child.id).length; i++) {\n                        var nodeS = this.reader.getNodeFromId(this.reader.getConnectedNodeParentsFromId(child.id)[i].id);\n\n                        if (nodeS.type === _redtype.redtype.scheduler) {\n                            this.setScheadulerNodeStatut(nodeS);\n                        }\n\n                        if (this.subcondition[this.reader.getConnectedNodeParentsFromId(child.id)[i].id] !== true) {\n                            conditionLogicAndOk = false;\n                        }\n                    }\n\n                    if (conditionLogicAndOk) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.logic_or:\n                    var conditionLogicOrOk = false;\n\n                    for (var _i = 0; _i < this.reader.getConnectedNodeParentsFromId(child.id).length; _i++) {\n                        if (this.subcondition[this.reader.getConnectedNodeParentsFromId(child.id)[_i].id] === true && !conditionLogicOrOk) {\n                            conditionLogicOrOk = true;\n                        }\n                    }\n\n                    if (conditionLogicOrOk) {\n                        this.subcondition[child.id] = true;\n                    } else {\n                        this.subcondition[child.id] = false;\n                    }\n                    break;\n\n                case _redtype.redtype.global_actuator:\n                    var conditionGlobalActuatorOk = true;\n\n                    for (var _i2 = 0; _i2 < this.reader.getConnectedNodeParentsFromId(child.id).length; _i2++) {\n                        if (this.subcondition[this.reader.getConnectedNodeParentsFromId(child.id)[_i2].id] !== true) {\n                            conditionGlobalActuatorOk = false;\n                        }\n                    }\n\n                    if (conditionGlobalActuatorOk) {\n                        this.subcondition[child.id] = true;\n\n                        if (this.socket !== null) {\n                            this.socket.emit(\"sensor-receive\", {\n                                sensor_type: \"relay\" + child.relaynumber,\n                                device_id: child.deviceid,\n                                sensor_mode: 1\n                            });\n                        }\n                    } else {\n                        this.subcondition[child.id] = false;\n\n                        if (this.socket !== null) {\n                            this.socket.emit(\"sensor-receive\", {\n                                sensor_type: \"relay\" + child.relaynumber,\n                                device_id: child.deviceid,\n                                sensor_mode: 0\n                            });\n                        }\n                    }\n                    break;\n            }\n\n            if (!finished) {\n                this.extractSubCondition(child.id);\n            } else {\n                if (this.queueEntryPoint.length > 0) {\n                    this.extractSubCondition(this.queueEntryPoint.shift().id);\n                } else {\n                    console.log(this.subcondition);\n                }\n            }\n        }\n    }]);\n\n    return Engine;\n}();\n\nexports.default = Engine;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9jbGFzcy9lbmdpbmUuanM/N2FhYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhZGVyIGZyb20gXCIuL3JlYWRlclwiO1xuaW1wb3J0IHsgcmVkdHlwZSB9IGZyb20gJy4uL2VudW1zL3JlZHR5cGUnO1xuaW1wb3J0IFNjaGVkdWxlciBmcm9tIFwiLi9zY2hlZHVsZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRW5naW5lIHtcbiAgICBjb25zdHJ1Y3RvcihzZW5zb3JIZWxwZXIsIGNvbmZpZ0hlbHBlcikge1xuICAgICAgICB0aGlzLnJlYWRlciA9IG5ldyBSZWFkZXIoY29uZmlnSGVscGVyKTtcbiAgICAgICAgdGhpcy5zZW5zb3JIZWxwZXIgPSBzZW5zb3JIZWxwZXI7XG4gICAgICAgIHRoaXMuY29uZmlnSGVscGVyID0gY29uZmlnSGVscGVyO1xuICAgICAgICB0aGlzLnNvY2tldCA9IG51bGw7XG4gICAgICAgIHRoaXMuaWRDeWNsZSA9ICcnO1xuXG4gICAgICAgIHRoaXMuc3ViY29uZGl0aW9uID0gW107XG4gICAgICAgIHRoaXMucXVldWVFbnRyeVBvaW50ID0gW107XG4gICAgfVxuXG4gICAgY29tcHV0ZSgpIHtcbiAgICAgICAgdGhpcy5pZEN5Y2xlID0gdGhpcy5nZXRJZEN5Y2xlKCk7XG5cbiAgICAgICAgaWYodGhpcy5jb25maWdIZWxwZXIuZ3JhcGggIT09IG51bGwpIHtcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnJlYWRlci5nZXRFbnRyeVBvaW50Tm9kZSgpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5xdWV1ZUVudHJ5UG9pbnQucHVzaCh0aGlzLnJlYWRlci5nZXRFbnRyeVBvaW50Tm9kZSgpW2ldKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5leHRyYWN0U3ViQ29uZGl0aW9uKHRoaXMucXVldWVFbnRyeVBvaW50LnNoaWZ0KCkuaWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SWRDeWNsZSgpIHtcbiAgICAgICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24oYykge1xuICAgICAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwLCB2ID0gYyA9PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpO1xuICAgICAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzZXRTb2NrZXQoc29ja2V0KSB7XG4gICAgICAgIHRoaXMuc29ja2V0ID0gc29ja2V0O1xuICAgIH1cblxuICAgIHNldFNjaGVhZHVsZXJOb2RlU3RhdHV0KG5vZGUpIHtcbiAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuc2NoZWR1bGVyW25vZGUuaWRdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vuc29ySGVscGVyLnNjaGVkdWxlcltub2RlLmlkXSA9IHtjeWNsZTp0aGlzLmlkQ3ljbGUsIHRpbWVzdGFtcDpNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCl9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuc2NoZWR1bGVyW25vZGUuaWRdLmN5Y2xlICE9PSB0aGlzLmlkQ3ljbGUpIHtcbiAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW25vZGUuaWRdID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZihuZXcgU2NoZWR1bGVyKG5vZGUsIHRoaXMuc2Vuc29ySGVscGVyLCB0aGlzLmlkQ3ljbGUpLmdldFNjaGVhZHVsZXJOb2RlU3RhdHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vuc29ySGVscGVyLnNjaGVkdWxlcltub2RlLmlkXSA9IHtjeWNsZTp0aGlzLmlkQ3ljbGUsIHRpbWVzdGFtcDpNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCl9O1xuICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bbm9kZS5pZF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZXh0cmFjdFN1YkNvbmRpdGlvbihlbnRyeXBvaW50KSB7XG4gICAgICAgIGxldCBmaW5pc2hlZCA9IGZhbHNlO1xuXG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLnJlYWRlci5nZXROb2RlRnJvbUlkKGVudHJ5cG9pbnQpO1xuICAgICAgICBsZXQgY2hpbGQgPSB0aGlzLnJlYWRlci5nZXROb2RlRnJvbUlkKHBhcmVudC53aXJlc1swXVswXSk7XG5cbiAgICAgICAgaWYoY2hpbGQud2lyZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmaW5pc2hlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKGNoaWxkLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgcmVkdHlwZS5tYXRoX2F2ZXJhZ2U6XG4gICAgICAgICAgICAgICAgbGV0IGFtb3VudCA9IGNoaWxkLmFtb3VudDtcbiAgICAgICAgICAgICAgICBpZihjaGlsZC5kZWxheVR5cGUgPT09ICdtaW51dGVzJykge1xuICAgICAgICAgICAgICAgICAgICBhbW91bnQgPSBhbW91bnQgKiA2MDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihjaGlsZC5kZWxheVR5cGUgPT09ICdob3VycycpIHtcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50ID0gYW1vdW50ICogMzYwMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2Vuc29ySGVscGVyLm1hdGhfYXZlcmFnZVtjaGlsZC5pZF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbnNvckhlbHBlci5tYXRoX2F2ZXJhZ2VbY2hpbGQuaWRdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbW91bnQgOiBhbW91bnRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiggKE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSAtIHRoaXMuc2Vuc29ySGVscGVyLm1hdGhfYXZlcmFnZVtjaGlsZC5pZF0udGltZXN0YW1wKSA+PSBhbW91bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Vuc29ySGVscGVyLm1hdGhfYXZlcmFnZVtjaGlsZC5pZF0udGltZXN0YW1wID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bY2hpbGQuaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSByZWR0eXBlLm1hdGhfaW5mZXJpb3I6XG4gICAgICAgICAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZSh0aGlzLmNvbmZpZ0hlbHBlci5kZXZpY2VpZCwgcGFyZW50LnR5cGUpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLnNlbnNvckhlbHBlci5nZXRTZW5zb3JWYWx1ZUJ5SWRBbmRUeXBlKHRoaXMuY29uZmlnSGVscGVyLmRldmljZWlkLCBwYXJlbnQudHlwZSkgPCBjaGlsZC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSByZWR0eXBlLm1hdGhfaW5mZXJpb3JfZXF1YWw6XG4gICAgICAgICAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZSh0aGlzLmNvbmZpZ0hlbHBlci5kZXZpY2VpZCwgcGFyZW50LnR5cGUpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLnNlbnNvckhlbHBlci5nZXRTZW5zb3JWYWx1ZUJ5SWRBbmRUeXBlKHRoaXMuY29uZmlnSGVscGVyLmRldmljZWlkLCBwYXJlbnQudHlwZSkgPD0gY2hpbGQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bY2hpbGQuaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgcmVkdHlwZS5tYXRoX2VxdWFsOlxuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2Vuc29ySGVscGVyLmdldFNlbnNvclZhbHVlQnlJZEFuZFR5cGUodGhpcy5jb25maWdIZWxwZXIuZGV2aWNlaWQsIHBhcmVudC50eXBlKSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZSh0aGlzLmNvbmZpZ0hlbHBlci5kZXZpY2VpZCwgcGFyZW50LnR5cGUpID09PSBjaGlsZC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSByZWR0eXBlLm1hdGhfc3VwZXJpb3I6XG4gICAgICAgICAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZSh0aGlzLmNvbmZpZ0hlbHBlci5kZXZpY2VpZCwgcGFyZW50LnR5cGUpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLnNlbnNvckhlbHBlci5nZXRTZW5zb3JWYWx1ZUJ5SWRBbmRUeXBlKHRoaXMuY29uZmlnSGVscGVyLmRldmljZWlkLCBwYXJlbnQudHlwZSkgPiBjaGlsZC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSByZWR0eXBlLm1hdGhfc3VwZXJpb3JfZXF1YWw6XG4gICAgICAgICAgICAgICAgaWYodGhpcy5zZW5zb3JIZWxwZXIuZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZSh0aGlzLmNvbmZpZ0hlbHBlci5kZXZpY2VpZCwgcGFyZW50LnR5cGUpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih0aGlzLnNlbnNvckhlbHBlci5nZXRTZW5zb3JWYWx1ZUJ5SWRBbmRUeXBlKHRoaXMuY29uZmlnSGVscGVyLmRldmljZWlkLCBwYXJlbnQudHlwZSkgPj0gY2hpbGQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bY2hpbGQuaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgcmVkdHlwZS5sb2dpY19hbmQ6XG4gICAgICAgICAgICAgICAgbGV0IGNvbmRpdGlvbkxvZ2ljQW5kT2sgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMucmVhZGVyLmdldENvbm5lY3RlZE5vZGVQYXJlbnRzRnJvbUlkKGNoaWxkLmlkKS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZVMgPSB0aGlzLnJlYWRlci5nZXROb2RlRnJvbUlkKHRoaXMucmVhZGVyLmdldENvbm5lY3RlZE5vZGVQYXJlbnRzRnJvbUlkKGNoaWxkLmlkKVtpXS5pZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYobm9kZVMudHlwZSA9PT0gcmVkdHlwZS5zY2hlZHVsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2NoZWFkdWxlck5vZGVTdGF0dXQobm9kZVMpXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnN1YmNvbmRpdGlvblt0aGlzLnJlYWRlci5nZXRDb25uZWN0ZWROb2RlUGFyZW50c0Zyb21JZChjaGlsZC5pZClbaV0uaWRdICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb25Mb2dpY0FuZE9rID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKGNvbmRpdGlvbkxvZ2ljQW5kT2spIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bY2hpbGQuaWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YmNvbmRpdGlvbltjaGlsZC5pZF0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgcmVkdHlwZS5sb2dpY19vcjpcbiAgICAgICAgICAgICAgICBsZXQgY29uZGl0aW9uTG9naWNPck9rID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5yZWFkZXIuZ2V0Q29ubmVjdGVkTm9kZVBhcmVudHNGcm9tSWQoY2hpbGQuaWQpLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuc3ViY29uZGl0aW9uW3RoaXMucmVhZGVyLmdldENvbm5lY3RlZE5vZGVQYXJlbnRzRnJvbUlkKGNoaWxkLmlkKVtpXS5pZF0gPT09IHRydWUgJiYgIWNvbmRpdGlvbkxvZ2ljT3JPaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uTG9naWNPck9rID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoY29uZGl0aW9uTG9naWNPck9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJjb25kaXRpb25bY2hpbGQuaWRdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIHJlZHR5cGUuZ2xvYmFsX2FjdHVhdG9yOlxuICAgICAgICAgICAgICAgIGxldCBjb25kaXRpb25HbG9iYWxBY3R1YXRvck9rID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLnJlYWRlci5nZXRDb25uZWN0ZWROb2RlUGFyZW50c0Zyb21JZChjaGlsZC5pZCkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5zdWJjb25kaXRpb25bdGhpcy5yZWFkZXIuZ2V0Q29ubmVjdGVkTm9kZVBhcmVudHNGcm9tSWQoY2hpbGQuaWQpW2ldLmlkXSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uR2xvYmFsQWN0dWF0b3JPayA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihjb25kaXRpb25HbG9iYWxBY3R1YXRvck9rKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5zb2NrZXQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KFwic2Vuc29yLXJlY2VpdmVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNvcl90eXBlOiBcInJlbGF5XCIgKyBjaGlsZC5yZWxheW51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VfaWQ6IGNoaWxkLmRldmljZWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNvcl9tb2RlOiAxXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ViY29uZGl0aW9uW2NoaWxkLmlkXSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuc29ja2V0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvY2tldC5lbWl0KFwic2Vuc29yLXJlY2VpdmVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNvcl90eXBlOiBcInJlbGF5XCIgKyBjaGlsZC5yZWxheW51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2VfaWQ6IGNoaWxkLmRldmljZWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNvcl9tb2RlOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCFmaW5pc2hlZCkge1xuICAgICAgICAgICAgdGhpcy5leHRyYWN0U3ViQ29uZGl0aW9uKGNoaWxkLmlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmKHRoaXMucXVldWVFbnRyeVBvaW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4dHJhY3RTdWJDb25kaXRpb24odGhpcy5xdWV1ZUVudHJ5UG9pbnQuc2hpZnQoKS5pZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3ViY29uZGl0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gY2xhc3MvZW5naW5lLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7O0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQS9KQTtBQUNBO0FBaUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUF2T0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/*!*************************!*\
  !*** ./class/reader.js ***!
  \*************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Reader = function () {\n    function Reader(configHelper) {\n        _classCallCheck(this, Reader);\n\n        this.configHelper = configHelper;\n    }\n\n    _createClass(Reader, [{\n        key: \"getEntryPointNode\",\n        value: function getEntryPointNode() {\n            var entryPointNode = [];\n\n            for (var i = 0; i < this.configHelper.graph.length; i++) {\n                var wires = [];\n\n                for (var j = 0; j < this.configHelper.graph.length; j++) {\n                    if (i !== j) {\n                        for (var k = 0; k < this.configHelper.graph[j].wires.length; k++) {\n                            for (var l = 0; l < this.configHelper.graph[j].wires[k].length; l++) {\n                                if (this.configHelper.graph[j].wires[k][l] === this.configHelper.graph[i].id) {\n                                    wires += this.configHelper.graph[j].wires[k][l];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (wires.length === 0) {\n                    entryPointNode.push(this.configHelper.graph[i]);\n                }\n            }\n\n            return entryPointNode;\n        }\n    }, {\n        key: \"getRelayNodes\",\n        value: function getRelayNodes() {\n            var nodeRelayIds = [];\n            var nodeRelay = [];\n\n            if (this.configHelper.graph !== null) {\n                for (var i = 0; i < this.configHelper.graph.length; i++) {\n                    if (this.configHelper.graph[i].type === \"global_actuator\") {\n                        if (nodeRelayIds.indexOf(this.configHelper.graph[i].deviceid) === -1) {\n                            nodeRelay.push({ deviceid: this.configHelper.graph[i].deviceid, relaynumber: this.configHelper.graph[i].relaynumber });\n                            nodeRelayIds.push(this.configHelper.graph[i].deviceid);\n                        }\n                    }\n                }\n            }\n\n            return nodeRelay;\n        }\n    }, {\n        key: \"getNodeFromId\",\n        value: function getNodeFromId(id) {\n            for (var i = 0; i < this.configHelper.graph.length; i++) {\n                if (this.configHelper.graph[i].id === id) {\n                    return this.configHelper.graph[i];\n                }\n            }\n        }\n    }, {\n        key: \"getConnectedNodeParentsFromId\",\n        value: function getConnectedNodeParentsFromId(id) {\n            var nodes = [];\n\n            for (var i = 0; i < this.configHelper.graph.length; i++) {\n                for (var j = 0; j < this.configHelper.graph[i].wires.length; j++) {\n\n                    for (var k = 0; k < this.configHelper.graph[i].wires[j].length; k++) {\n                        if (this.configHelper.graph[i].wires[j][k] === id) {\n                            nodes.push(this.configHelper.graph[i]);\n                        }\n                    }\n                }\n            }\n\n            return nodes;\n        }\n    }]);\n\n    return Reader;\n}();\n\nexports.default = Reader;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9jbGFzcy9yZWFkZXIuanM/NGNiZCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZ0hlbHBlcikge1xuICAgICAgICB0aGlzLmNvbmZpZ0hlbHBlciA9IGNvbmZpZ0hlbHBlcjtcbiAgICB9XG5cbiAgICBnZXRFbnRyeVBvaW50Tm9kZSgpIHtcbiAgICAgICAgbGV0IGVudHJ5UG9pbnROb2RlID0gW107XG5cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuY29uZmlnSGVscGVyLmdyYXBoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgd2lyZXMgPSBbXTtcblxuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHRoaXMuY29uZmlnSGVscGVyLmdyYXBoLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYoaSAhPT0gaikge1xuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGsgPSAwOyBrIDwgdGhpcy5jb25maWdIZWxwZXIuZ3JhcGhbal0ud2lyZXMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgbCA9IDA7IGwgPCB0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtqXS53aXJlc1trXS5sZW5ndGg7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2pdLndpcmVzW2tdW2xdID09PSB0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXJlcyArPSB0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtqXS53aXJlc1trXVtsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3aXJlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBlbnRyeVBvaW50Tm9kZS5wdXNoKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGVudHJ5UG9pbnROb2RlO1xuICAgIH1cblxuICAgIGdldFJlbGF5Tm9kZXMoKSB7XG4gICAgICAgIGxldCBub2RlUmVsYXlJZHMgPSBbXTtcbiAgICAgICAgbGV0IG5vZGVSZWxheSA9IFtdO1xuXG4gICAgICAgIGlmKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoICE9PSBudWxsKSB7XG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jb25maWdIZWxwZXIuZ3JhcGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtpXS50eXBlID09PSBcImdsb2JhbF9hY3R1YXRvclwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKG5vZGVSZWxheUlkcy5pbmRleE9mKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldLmRldmljZWlkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVSZWxheS5wdXNoKHtkZXZpY2VpZDp0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtpXS5kZXZpY2VpZCwgcmVsYXludW1iZXI6dGhpcy5jb25maWdIZWxwZXIuZ3JhcGhbaV0ucmVsYXludW1iZXJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVSZWxheUlkcy5wdXNoKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldLmRldmljZWlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBub2RlUmVsYXk7XG4gICAgfVxuXG4gICAgZ2V0Tm9kZUZyb21JZChpZCkge1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jb25maWdIZWxwZXIuZ3JhcGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldLmlkID09PSBpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaFtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldENvbm5lY3RlZE5vZGVQYXJlbnRzRnJvbUlkKGlkKSB7XG4gICAgICAgIGxldCBub2RlcyA9IFtdO1xuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNvbmZpZ0hlbHBlci5ncmFwaC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldLndpcmVzLmxlbmd0aDsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICBmb3IobGV0IGsgPSAwOyBrIDwgdGhpcy5jb25maWdIZWxwZXIuZ3JhcGhbaV0ud2lyZXNbal0ubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jb25maWdIZWxwZXIuZ3JhcGhbaV0ud2lyZXNbal1ba10gPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHRoaXMuY29uZmlnSGVscGVyLmdyYXBoW2ldKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gY2xhc3MvcmVhZGVyLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUF2RUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/*!****************************!*\
  !*** ./class/scheduler.js ***!
  \****************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Scheduler = function () {\n    function Scheduler(data, sensorHelper, cycle) {\n        _classCallCheck(this, Scheduler);\n\n        this.data = data;\n        this.sensorHelper = sensorHelper;\n        this.cycle = cycle;\n\n        this.initValues(data);\n    }\n\n    _createClass(Scheduler, [{\n        key: 'initValues',\n        value: function initValues(data) {\n            this.current = new Date();\n            this.currentTimestamp = Math.round(new Date().getTime() / 1000);\n            this.currentHour = this.current.getHours();\n            this.currentMinutes = this.current.getMinutes();\n            this.startHour = parseInt(data.startHour);\n            this.startMinute = parseInt(data.startMinute);\n            this.endHour = parseInt(data.endHour);\n            this.endMinute = parseInt(data.endMinute);\n            this.onceMinute = parseInt(data.onceMinute);\n            this.onceHour = parseInt(data.onceHour);\n            this.interval = parseInt(data.interval);\n            this.days = data.days;\n            this.day = data.day;\n            this.inRange = false;\n        }\n    }, {\n        key: 'getScheadulerNodeStatut',\n        value: function getScheadulerNodeStatut() {\n            if (this.data.sendFrequency === 'interval' && this.data.sendRange === 'time-range') {\n                this.checkRange();\n            } else if (this.data.sendFrequency === 'interval' && this.data.sendRange === 'all-day') {\n                this.inRange = true;\n            } else if (this.data.sendFrequency === 'once') {\n                this.checkOnce();\n            }\n\n            if (this.data.sendDay === 'days') {\n                if (!this.getScheadulerSendDays()) {\n                    this.inRange = false;\n                }\n            }\n\n            if (this.data.sendDay === 'oneDay') {\n                if (!this.getScheadulerSendOneDay()) {\n                    this.inRange = false;\n                }\n            }\n\n            return this.checkInterval();\n        }\n    }, {\n        key: 'checkRange',\n        value: function checkRange() {\n            if (this.currentHour > this.startHour) {\n                if (this.currentHour < this.endHour) {\n                    this.inRange = true;\n                } else if (this.currentHour === this.endHour) {\n                    if (this.currentMinutes < this.endMinute) {\n                        this.inRange = true;\n                    }\n                }\n            } else if (this.currentHour === this.startHour) {\n                if (this.currentMinutes >= this.startMinute) {\n                    if (this.currentHour < this.endHour) {\n                        this.inRange = true;\n                    } else if (this.currentHour === this.endHour) {\n                        if (this.currentMinutes <= this.endMinute) {\n                            this.inRange = true;\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'getScheadulerSendDays',\n        value: function getScheadulerSendDays() {\n            return this.days[this.current.getDay() - 1];\n        }\n    }, {\n        key: 'getScheadulerSendOneDay',\n        value: function getScheadulerSendOneDay() {\n            return this.day === this.current.getDate();\n        }\n    }, {\n        key: 'checkOnce',\n        value: function checkOnce() {\n            if (this.onceMinute === this.current.getMinutes() && this.onceHour === this.current.getHours()) {\n                return this.inRange = true;\n            }\n        }\n    }, {\n        key: 'checkInterval',\n        value: function checkInterval() {\n            if (this.inRange) {\n                if (this.data.intervalUnits === 'minutes' && this.data.sendFrequency !== 'once') {\n                    var minutesFromLastActivation = (this.currentTimestamp - this.sensorHelper.scheduler[this.data.id].timestamp) / 60;\n\n                    if (minutesFromLastActivation >= this.interval) {\n                        return true;\n                    }\n                } else if (this.data.intervalUnits === 'minutes' && this.data.sendFrequency === 'once') {\n                    var _minutesFromLastActivation = (this.currentTimestamp - this.sensorHelper.scheduler[this.data.id].timestamp) / 60;\n\n                    if (_minutesFromLastActivation >= 0.6) {\n                        return true;\n                    }\n                } else if (this.data.intervalUnits === 'hours') {\n                    var hoursFromLastActivation = (this.currentTimestamp - this.sensorHelper.scheduler[this.data.id].timestamp) / 3600;\n\n                    if (hoursFromLastActivation >= this.interval) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        }\n    }]);\n\n    return Scheduler;\n}();\n\nexports.default = Scheduler;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9jbGFzcy9zY2hlZHVsZXIuanM/NGI4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBTY2hlZHVsZXIge1xuICAgIGNvbnN0cnVjdG9yKGRhdGEsIHNlbnNvckhlbHBlciwgY3ljbGUpIHtcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5zZW5zb3JIZWxwZXIgPSBzZW5zb3JIZWxwZXI7XG4gICAgICAgIHRoaXMuY3ljbGUgPSBjeWNsZTtcblxuICAgICAgICB0aGlzLmluaXRWYWx1ZXMoZGF0YSk7XG4gICAgfVxuXG4gICAgaW5pdFZhbHVlcyhkYXRhKSB7XG4gICAgICAgIHRoaXMuY3VycmVudCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHRoaXMuY3VycmVudFRpbWVzdGFtcCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICAgICAgdGhpcy5jdXJyZW50SG91ciA9IHRoaXMuY3VycmVudC5nZXRIb3VycygpO1xuICAgICAgICB0aGlzLmN1cnJlbnRNaW51dGVzID0gdGhpcy5jdXJyZW50LmdldE1pbnV0ZXMoKTtcbiAgICAgICAgdGhpcy5zdGFydEhvdXIgPSBwYXJzZUludChkYXRhLnN0YXJ0SG91cik7XG4gICAgICAgIHRoaXMuc3RhcnRNaW51dGUgPSBwYXJzZUludChkYXRhLnN0YXJ0TWludXRlKTtcbiAgICAgICAgdGhpcy5lbmRIb3VyID0gcGFyc2VJbnQoZGF0YS5lbmRIb3VyKTtcbiAgICAgICAgdGhpcy5lbmRNaW51dGUgPSBwYXJzZUludChkYXRhLmVuZE1pbnV0ZSk7XG4gICAgICAgIHRoaXMub25jZU1pbnV0ZSA9IHBhcnNlSW50KGRhdGEub25jZU1pbnV0ZSk7XG4gICAgICAgIHRoaXMub25jZUhvdXIgPSBwYXJzZUludChkYXRhLm9uY2VIb3VyKTtcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IHBhcnNlSW50KGRhdGEuaW50ZXJ2YWwpO1xuICAgICAgICB0aGlzLmRheXMgPSBkYXRhLmRheXM7XG4gICAgICAgIHRoaXMuZGF5ID0gZGF0YS5kYXk7XG4gICAgICAgIHRoaXMuaW5SYW5nZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGdldFNjaGVhZHVsZXJOb2RlU3RhdHV0KCkge1xuICAgICAgICBpZih0aGlzLmRhdGEuc2VuZEZyZXF1ZW5jeSA9PT0gJ2ludGVydmFsJyAmJiB0aGlzLmRhdGEuc2VuZFJhbmdlID09PSAndGltZS1yYW5nZScpIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tSYW5nZSgpO1xuICAgICAgICB9IGVsc2UgaWYodGhpcy5kYXRhLnNlbmRGcmVxdWVuY3kgPT09ICdpbnRlcnZhbCcgJiYgdGhpcy5kYXRhLnNlbmRSYW5nZSA9PT0gJ2FsbC1kYXknKSB7XG4gICAgICAgICAgICB0aGlzLmluUmFuZ2UgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYodGhpcy5kYXRhLnNlbmRGcmVxdWVuY3kgPT09ICdvbmNlJykge1xuICAgICAgICAgICAgdGhpcy5jaGVja09uY2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMuZGF0YS5zZW5kRGF5ID09PSAnZGF5cycpIHtcbiAgICAgICAgICAgIGlmKCF0aGlzLmdldFNjaGVhZHVsZXJTZW5kRGF5cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pblJhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZih0aGlzLmRhdGEuc2VuZERheSA9PT0gJ29uZURheScpIHtcbiAgICAgICAgICAgIGlmKCF0aGlzLmdldFNjaGVhZHVsZXJTZW5kT25lRGF5KCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluUmFuZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrSW50ZXJ2YWwoKTtcbiAgICB9XG5cbiAgICBjaGVja1JhbmdlKCkge1xuICAgICAgICBpZih0aGlzLmN1cnJlbnRIb3VyID4gdGhpcy5zdGFydEhvdXIpIHtcbiAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudEhvdXIgPCB0aGlzLmVuZEhvdXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluUmFuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuY3VycmVudEhvdXIgPT09IHRoaXMuZW5kSG91cikge1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudE1pbnV0ZXMgPCB0aGlzLmVuZE1pbnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluUmFuZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRIb3VyID09PSB0aGlzLnN0YXJ0SG91cikge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE1pbnV0ZXMgPj0gdGhpcy5zdGFydE1pbnV0ZSkge1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudEhvdXIgPCB0aGlzLmVuZEhvdXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pblJhbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYodGhpcy5jdXJyZW50SG91ciA9PT0gdGhpcy5lbmRIb3VyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudE1pbnV0ZXMgPD0gdGhpcy5lbmRNaW51dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5SYW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTY2hlYWR1bGVyU2VuZERheXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRheXNbdGhpcy5jdXJyZW50LmdldERheSgpIC0gMV07XG4gICAgfVxuXG5cbiAgICBnZXRTY2hlYWR1bGVyU2VuZE9uZURheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF5ID09PSB0aGlzLmN1cnJlbnQuZ2V0RGF0ZSgpO1xuICAgIH1cblxuXG4gICAgY2hlY2tPbmNlKCkge1xuICAgICAgICBpZih0aGlzLm9uY2VNaW51dGUgPT09IHRoaXMuY3VycmVudC5nZXRNaW51dGVzKCkgJiYgdGhpcy5vbmNlSG91ciA9PT0gdGhpcy5jdXJyZW50LmdldEhvdXJzKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluUmFuZ2UgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2hlY2tJbnRlcnZhbCgpIHtcbiAgICAgICAgaWYodGhpcy5pblJhbmdlKSB7XG4gICAgICAgICAgICBpZih0aGlzLmRhdGEuaW50ZXJ2YWxVbml0cyA9PT0gJ21pbnV0ZXMnICYmIHRoaXMuZGF0YS5zZW5kRnJlcXVlbmN5ICE9PSAnb25jZScpIHtcbiAgICAgICAgICAgICAgICBsZXQgbWludXRlc0Zyb21MYXN0QWN0aXZhdGlvbiA9ICh0aGlzLmN1cnJlbnRUaW1lc3RhbXAgLSB0aGlzLnNlbnNvckhlbHBlci5zY2hlZHVsZXJbdGhpcy5kYXRhLmlkXS50aW1lc3RhbXApIC8gNjA7XG5cbiAgICAgICAgICAgICAgICBpZihtaW51dGVzRnJvbUxhc3RBY3RpdmF0aW9uID49IHRoaXMuaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuZGF0YS5pbnRlcnZhbFVuaXRzID09PSAnbWludXRlcycgJiYgdGhpcy5kYXRhLnNlbmRGcmVxdWVuY3kgPT09ICdvbmNlJykge1xuICAgICAgICAgICAgICAgIGxldCBtaW51dGVzRnJvbUxhc3RBY3RpdmF0aW9uID0gKHRoaXMuY3VycmVudFRpbWVzdGFtcCAtIHRoaXMuc2Vuc29ySGVscGVyLnNjaGVkdWxlclt0aGlzLmRhdGEuaWRdLnRpbWVzdGFtcCkgLyA2MDtcblxuICAgICAgICAgICAgICAgIGlmKG1pbnV0ZXNGcm9tTGFzdEFjdGl2YXRpb24gPj0gMC42KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZGF0YS5pbnRlcnZhbFVuaXRzID09PSAnaG91cnMnKSB7XG4gICAgICAgICAgICAgICAgbGV0IGhvdXJzRnJvbUxhc3RBY3RpdmF0aW9uID0gKHRoaXMuY3VycmVudFRpbWVzdGFtcCAtIHRoaXMuc2Vuc29ySGVscGVyLnNjaGVkdWxlclt0aGlzLmRhdGEuaWRdLnRpbWVzdGFtcCkgLyAzNjAwO1xuXG4gICAgICAgICAgICAgICAgaWYoaG91cnNGcm9tTGFzdEFjdGl2YXRpb24gPj0gdGhpcy5pbnRlcnZhbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBjbGFzcy9zY2hlZHVsZXIuanMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQWpIQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4\n");

/***/ }),
/* 5 */
/*!*************************!*\
  !*** ./class/sensor.js ***!
  \*************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _redtype = __webpack_require__(/*! ../enums/redtype */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Sensor = function () {\n    function Sensor() {\n        _classCallCheck(this, Sensor);\n\n        this.data = {};\n        this.math_average = {};\n        this.dli_last_update = Date.now();\n        this.scheduler = {};\n        this.maxBufferTimeHours = 0.1;\n    }\n\n    _createClass(Sensor, [{\n        key: \"updateData\",\n        value: function updateData(data) {\n            data = JSON.parse(data);\n\n            if (data.sensor_type === 'light_par') {\n                this.storeDLI(data);\n            }\n\n            this.data[data.sensor_id + \"sensor_\" + data.sensor_type] = data;\n\n            var dataWithTs = {\n                timestamp: Math.round(new Date().getTime() / 1000),\n                data: data\n            };\n\n            if (this.data[data.sensor_id + \"sensor_\" + data.sensor_type + '_ts'] === undefined) {\n                this.data[data.sensor_id + \"sensor_\" + data.sensor_type + '_ts'] = [];\n                this.data[data.sensor_id + \"sensor_\" + data.sensor_type + '_ts'].push(dataWithTs);\n            } else {\n                this.data[data.sensor_id + \"sensor_\" + data.sensor_type + '_ts'].push(dataWithTs);\n            }\n\n            this.cleanBuffer();\n        }\n    }, {\n        key: \"cleanBuffer\",\n        value: function cleanBuffer() {\n            var timestamp = Math.round(new Date().getTime() / 1000);\n            var timestampShift = timestamp - this.maxBufferTimeHours * 3600;\n\n            var keys = Object.keys(this.data);\n\n            for (var i = 0; i < keys.length; i++) {\n                if (keys[i].indexOf('_ts') !== -1) {\n                    for (var j = 0; j < this.data[keys[i]].length; j++) {\n                        if (this.data[keys[i]][j].timestamp < timestampShift) {\n                            this.data[keys[i]].shift();\n                        } else {\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: \"getSensorValueByIdAndType\",\n        value: function getSensorValueByIdAndType(id, type) {\n            if (this.data[id + type] !== undefined) {\n                if (this.data[id + type].sensor_value !== undefined) {\n                    return this.data[id + type].sensor_value;\n                } else {\n                    return null;\n                }\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"getSensorValueByIdAndTypeAverage\",\n        value: function getSensorValueByIdAndTypeAverage(id, type, seconds) {\n            var averageValues = [];\n            var timestamp = Math.round(new Date().getTime() / 1000) - seconds;\n\n            var last = 0;\n            var first = 0;\n\n            for (var i = this.data[id + type + '_ts'].length - 1; i > 0; i--) {\n                if (i === this.data[id + type + '_ts'].length - 1) {\n                    last = this.data[id + type + '_ts'][i].timestamp;\n                }\n\n                if (timestamp - this.data[id + type + '_ts'][i].timestamp < seconds) {\n                    averageValues.push(parseInt(this.data[id + type + '_ts'][i].data.sensor_value));\n                } else {\n                    first = this.data[id + type + '_ts'][i + 1].timestamp;\n                    break;\n                }\n            }\n\n            var storeDelay = 0;\n\n            if (first !== 0) {\n                storeDelay = last - first;\n            }\n\n            return { storeDelay: storeDelay, value: this.getSumFromArrayAverage(averageValues) };\n        }\n    }, {\n        key: \"getSumFromArrayAverage\",\n        value: function getSumFromArrayAverage(averageValues) {\n            var sum = 0;\n\n            for (var i = 0; i < averageValues.length; i++) {\n                sum += parseInt(averageValues[i], 10);\n            }\n\n            return Math.floor(sum / averageValues.length);\n        }\n    }, {\n        key: \"storeDLI\",\n        value: function storeDLI(data) {\n            var time = Date.now();\n            var deltaT = time - this.dli_last_update;\n            var mult = deltaT / 1000;\n\n            var value = 0;\n\n            if (this.data[data.sensor_id + \"sensor_light_dli\"] !== undefined) {\n                value = this.data[data.sensor_id + \"sensor_light_dli\"].sensor_value;\n            }\n\n            this.data[data.sensor_id + \"sensor_light_dli\"] = { device_id: data.device_id,\n                sensor_type: 'light_dli',\n                sensor_id: data.sensor_id,\n                sensor_value: value + parseFloat(data.sensor_value) * mult / 1000000 };\n\n            this.dli_last_update = time;\n        }\n    }]);\n\n    return Sensor;\n}();\n\nexports.default = Sensor;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9jbGFzcy9zZW5zb3IuanM/YjhlMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3JlZHR5cGV9IGZyb20gXCIuLi9lbnVtcy9yZWR0eXBlXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlbnNvciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IHt9O1xuICAgICAgICB0aGlzLm1hdGhfYXZlcmFnZSA9IHt9O1xuICAgICAgICB0aGlzLmRsaV9sYXN0X3VwZGF0ZSA9IERhdGUubm93KCk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyID0ge307XG4gICAgICAgIHRoaXMubWF4QnVmZmVyVGltZUhvdXJzID0gMC4xO1xuICAgIH1cblxuICAgIHVwZGF0ZURhdGEoZGF0YSkge1xuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblxuXG4gICAgICAgIGlmKGRhdGEuc2Vuc29yX3R5cGUgPT09ICdsaWdodF9wYXInKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3JlRExJKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kYXRhW2RhdGEuc2Vuc29yX2lkK1wic2Vuc29yX1wiK2RhdGEuc2Vuc29yX3R5cGVdID0gZGF0YTtcblxuXG4gICAgICAgIGxldCBkYXRhV2l0aFRzID0ge1xuICAgICAgICAgICAgdGltZXN0YW1wOiBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCksXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYodGhpcy5kYXRhW2RhdGEuc2Vuc29yX2lkK1wic2Vuc29yX1wiK2RhdGEuc2Vuc29yX3R5cGUrJ190cyddID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YVtkYXRhLnNlbnNvcl9pZCtcInNlbnNvcl9cIitkYXRhLnNlbnNvcl90eXBlKydfdHMnXSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5kYXRhW2RhdGEuc2Vuc29yX2lkK1wic2Vuc29yX1wiK2RhdGEuc2Vuc29yX3R5cGUrJ190cyddLnB1c2goZGF0YVdpdGhUcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFbZGF0YS5zZW5zb3JfaWQrXCJzZW5zb3JfXCIrZGF0YS5zZW5zb3JfdHlwZSsnX3RzJ10ucHVzaChkYXRhV2l0aFRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2xlYW5CdWZmZXIoKTtcbiAgICB9XG5cbiAgICBjbGVhbkJ1ZmZlcigpIHtcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICAgICAgdmFyIHRpbWVzdGFtcFNoaWZ0ID0gdGltZXN0YW1wIC0gKHRoaXMubWF4QnVmZmVyVGltZUhvdXJzICogMzYwMCk7XG5cbiAgICAgICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmRhdGEpO1xuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZihrZXlzW2ldLmluZGV4T2YoJ190cycpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaiA9IDA7IGogPCB0aGlzLmRhdGFba2V5c1tpXV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5kYXRhW2tleXNbaV1dW2pdLnRpbWVzdGFtcCA8IHRpbWVzdGFtcFNoaWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFba2V5c1tpXV0uc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0U2Vuc29yVmFsdWVCeUlkQW5kVHlwZShpZCwgdHlwZSkge1xuICAgICAgICBpZih0aGlzLmRhdGFbaWQrdHlwZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYodGhpcy5kYXRhW2lkK3R5cGVdLnNlbnNvcl92YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVtpZCt0eXBlXS5zZW5zb3JfdmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRTZW5zb3JWYWx1ZUJ5SWRBbmRUeXBlQXZlcmFnZShpZCwgdHlwZSwgc2Vjb25kcykge1xuICAgICAgICBsZXQgYXZlcmFnZVZhbHVlcyA9IFtdO1xuICAgICAgICBsZXQgdGltZXN0YW1wID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIC0gc2Vjb25kcztcblxuICAgICAgICBsZXQgbGFzdCA9IDA7XG4gICAgICAgIGxldCBmaXJzdCA9IDA7XG5cbiAgICAgICAgZm9yKGxldCBpID0gdGhpcy5kYXRhW2lkK3R5cGUrJ190cyddLmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmKGkgPT09IHRoaXMuZGF0YVtpZCt0eXBlKydfdHMnXS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgbGFzdCA9IHRoaXMuZGF0YVtpZCt0eXBlKydfdHMnXVtpXS50aW1lc3RhbXA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKCh0aW1lc3RhbXAgLSB0aGlzLmRhdGFbaWQrdHlwZSsnX3RzJ11baV0udGltZXN0YW1wKSA8IHNlY29uZHMpIHtcbiAgICAgICAgICAgICAgICBhdmVyYWdlVmFsdWVzLnB1c2gocGFyc2VJbnQodGhpcy5kYXRhW2lkK3R5cGUrJ190cyddW2ldLmRhdGEuc2Vuc29yX3ZhbHVlKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpcnN0ID0gdGhpcy5kYXRhW2lkK3R5cGUrJ190cyddW2kgKyAxXS50aW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc3RvcmVEZWxheSA9IDA7XG5cbiAgICAgICAgaWYoZmlyc3QgIT09IDApIHtcbiAgICAgICAgICAgIHN0b3JlRGVsYXkgPSBsYXN0IC0gZmlyc3RcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7c3RvcmVEZWxheTogc3RvcmVEZWxheSwgdmFsdWU6IHRoaXMuZ2V0U3VtRnJvbUFycmF5QXZlcmFnZShhdmVyYWdlVmFsdWVzKX07XG4gICAgfVxuXG4gICAgZ2V0U3VtRnJvbUFycmF5QXZlcmFnZShhdmVyYWdlVmFsdWVzKSB7XG4gICAgICAgIHZhciBzdW0gPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXZlcmFnZVZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc3VtICs9IHBhcnNlSW50KCBhdmVyYWdlVmFsdWVzW2ldLCAxMCApO1xuICAgICAgICB9XG5cbiAgICAgICByZXR1cm4gTWF0aC5mbG9vcihzdW0gLyBhdmVyYWdlVmFsdWVzLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgc3RvcmVETEkoZGF0YSkge1xuICAgICAgICB2YXIgdGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHZhciBkZWx0YVQgPSB0aW1lIC0gdGhpcy5kbGlfbGFzdF91cGRhdGU7XG4gICAgICAgIHZhciBtdWx0ID0gZGVsdGFUIC8gMTAwMDtcblxuICAgICAgICB2YXIgdmFsdWUgPSAwO1xuXG4gICAgICAgIGlmKHRoaXMuZGF0YVtkYXRhLnNlbnNvcl9pZCtcInNlbnNvcl9saWdodF9kbGlcIl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFsdWUgPSB0aGlzLmRhdGFbZGF0YS5zZW5zb3JfaWQrXCJzZW5zb3JfbGlnaHRfZGxpXCJdLnNlbnNvcl92YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGF0YVtkYXRhLnNlbnNvcl9pZCtcInNlbnNvcl9saWdodF9kbGlcIl0gPSB7IGRldmljZV9pZDogZGF0YS5kZXZpY2VfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5zb3JfdHlwZTogJ2xpZ2h0X2RsaScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5zb3JfaWQ6IGRhdGEuc2Vuc29yX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vuc29yX3ZhbHVlOiAodmFsdWUgKyAocGFyc2VGbG9hdChkYXRhLnNlbnNvcl92YWx1ZSkgKiBtdWx0KSAvIDEwMDAwMDApIH07XG5cbiAgICAgICAgdGhpcy5kbGlfbGFzdF91cGRhdGUgPSB0aW1lO1xuICAgIH1cbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gY2xhc3Mvc2Vuc29yLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUExSEEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///5\n");

/***/ }),
/* 6 */
/*!*******************************!*\
  !*** ./class/ConfigHelper.js ***!
  \*******************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ConfigHelper = function () {\n    function ConfigHelper() {\n        _classCallCheck(this, ConfigHelper);\n\n        this.engine = {};\n        this.deviceid = '0';\n        this.graph = null;\n        this.ready = false;\n    }\n\n    _createClass(ConfigHelper, [{\n        key: \"getConfig\",\n        value: function getConfig() {\n            var relays = this.engine.reader.getRelayNodes();\n            var type = \"client\";\n\n            for (var i = 0; i < relays.length; i++) {\n                if (relays[i].deviceid !== undefined) {\n                    if (relays[i].deviceid === this.deviceid) {\n                        type = \"server\";\n                        break;\n                    }\n                }\n            }\n\n            return {\n                type: type,\n                relays: relays\n            };\n        }\n    }]);\n\n    return ConfigHelper;\n}();\n\nexports.default = ConfigHelper;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9jbGFzcy9Db25maWdIZWxwZXIuanM/NDMwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDb25maWdIZWxwZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmVuZ2luZSA9IHt9O1xuICAgICAgICB0aGlzLmRldmljZWlkID0gJzAnO1xuICAgICAgICB0aGlzLmdyYXBoID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGdldENvbmZpZygpIHtcbiAgICAgICAgdmFyIHJlbGF5cyA9IHRoaXMuZW5naW5lLnJlYWRlci5nZXRSZWxheU5vZGVzKCk7XG4gICAgICAgIHZhciB0eXBlID0gXCJjbGllbnRcIjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbGF5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYocmVsYXlzW2ldLmRldmljZWlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVsYXlzW2ldLmRldmljZWlkID09PSB0aGlzLmRldmljZWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBcInNlcnZlclwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIHJlbGF5czogcmVsYXlzXG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGNsYXNzL0NvbmZpZ0hlbHBlci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7Ozs7OztBQXpCQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///6\n");

/***/ })
/******/ ]);